using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using Oracle.DataAccess.Client;
using Oracle.DataAccess.Types;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        OracleConnection conn;
        OracleCommand comm;
        OracleDataAdapter da;
        DataSet ds;
        DataTable dt;
        DataRow dr;
        int i = 0;
        public Form1()
        {
            InitializeComponent();
        }

        public void connect1()
        {
            String oradb = "Data Source=ictorcl;User ID=it308;Password=student";
            conn = new OracleConnection(oradb);
            conn.Open();
        }
         private void Form1_Load(object sender, EventArgs e)
        {

        }

         private void button1_Click(object sender, EventArgs e)
         {
             connect1();
             comm = new OracleCommand();
             comm.CommandText = "select * from customer308";
             comm.CommandType = CommandType.Text;
             ds = new DataSet();
             da = new OracleDataAdapter(comm.CommandText,conn);
             da.Fill(ds,"customer308");
             dt=ds.Tables["customer308"];
             int t = dt.Rows.Count;
             MessageBox.Show(t.ToString());
             dr = dt.Rows[i];
             textBox1.Text = dr["customer_id"].ToString();
             textBox2.Text = dr["city"].ToString();
             textBox3.Text = dr["name"].ToString();
             conn.Close();
         }

         private void button2_Click(object sender, EventArgs e)
         {
             i++;
             if (i > dt.Rows.Count)
                 i = 0;
             dr = dt.Rows[i];
             textBox1.Text = dr["customer_id"].ToString();
             textBox2.Text = dr["city"].ToString();
             textBox3.Text = dr["name"].ToString(); 
         }

         private void button3_Click(object sender, EventArgs e)
         {
             i--;
             if (i < 0)
                 i = dt.Rows.Count-1;
             dr = dt.Rows[i];
             textBox1.Text = dr["customer_id"].ToString();
             textBox2.Text = dr["city"].ToString();
             textBox3.Text = dr["name"].ToString(); 
         }

         private void button4_Click(object sender, EventArgs e)
         {
             connect1();
             int customer_id = int.Parse(textBox1.Text);
             OracleCommand cm = new OracleCommand();
             cm.Connection = conn;
             comm.CommandText = "insert into customer308 values('" + textBox1.Text + "','" + textBox2.Text + "','" + textBox3.Text + "','" + textBox3.Text + "')";
             cm.CommandType = CommandType.Text;
             cm.ExecuteNonQuery();
             MessageBox.Show("inserted!");
             conn.Close();
         }

         private void button5_Click(object sender, EventArgs e)
         {
             connect1();
             int v=int.Parse(textBox1.Text);
             OracleCommand cm = new OracleCommand();
             cm.Connection = conn;
             cm.CommandText = "updates customer308 set cust_id=:pb where name=:pbn";
             cm.CommandType = CommandType.Text;
             OracleParameter pa1 = new OracleParameter();
             pa1.ParameterName ="pb";
             pa1.DbType = DbType.Int32;
             pa1.Value = v;
             OracleParameter pa2 = new OracleParameter();
             pa2.ParameterName = "pdn";
             pa2.DbType = DbType.String;
             pa2.Value = textBox1.Text;
             cm.Parameters.Add(pa1);
             cm.Parameters.Add(pa2);
             cm.ExecuteNonQuery();
             MessageBox.Show("updated");
             conn.Close();
         }
       

    }
}